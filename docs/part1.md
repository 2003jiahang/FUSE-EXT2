# 实验概述

## 1.  实验目的

以Linux系统中的**EXT2**文件系统为例，熟悉该文件系统内部数据结构的组织方式和基本处理流程，并基于**FUSE**设计并实现一个可以**真正在Linux上跑**的文件系统。

## 2.  实验学时

本实验为8学时。

## 3.  实验内容

### 3.1 必做部分

- **熟悉DDRIVER驱动** （参考 **实验原理-DDRIVER虚拟磁盘驱动**） 

  本实验要求通过**ddriver（disk driver）**驱动来访问ddriver设备，从而简化磁盘访问操作。此后，我们便可以利用ddriver驱动来编写自己的文件系统。“**工欲善其事，必先利其器**”，在实验过程中，请务必保证你已经理解**tests/test_ddriver.c**目录下给出的案例。

- **基于FUSE实现青春版EXT2文件系统**（参考 **实验原理-FUSE介绍与Ext2文件系统原理简介**）

  系统结构参考EXT2文件系统，要求具有`SUPER_BLOCK`、`DATA_MAP`、`INODE_MAP`等主要结构。本实验基于FUSE架构，要求将自己设计的文件系统接入FUSE，使得我们能够在Linux系统中直接访问我们自己的文件系统，是不是很酷炫呢？**言归正传**，本次实验仅要求完成如下几个功能：

  1. 挂载文件系统；
  2. 卸载文件系统；
  3. 创建文件/文件夹（数据块可预分配）；
  4. 查看文件夹下的文件（读取文件夹内容）；

  上述功能对应的命令为：

  1. mount
  2. umount
  3. touch/mkdir
  4. ls

  以上未提及的功能（如复制、删除、读写文件等）**不要求实现**。 具体要求参见**实验内容**和**实验要求**。

### 3.2 选做部分

本选做部分仅为学有余力的大佬秀操作提供方向。为防止内卷，实现本部分**不会**带来额外加分（但或许会有其他意想不到的惊喜），秀翻车了也不会扣分。

- **EXPERT：完善文件系统基本操作**
  1. **按需分配**文件数据块
  2. 间接索引和二级间接索引
  3. 删除操作（rm命令，需要支持rm -r）
  4. 文件移动（mv命令）
  5. 读写文件（支持vim、vscode直接修改文件）
  6. 软硬连接（ln命令）
- **SUPERME：思华的文件读写体验**
  1. 实现缓存结构（参考**实验原理-磁盘缓存简介**）
- **EPIC：超强的鲁棒性**
  1. 启动时检查系统一致性（孤儿节点、空闲节点与位图是否一致、更多一致性检测）
  2. 坏块识别与处理（动态识别坏块，并避免使用）
  3. 日志（参考**实验原理-日志文件系统简介**）

## 3.3 运行示例

<video src="part1.assets/demo.mp4"></video>

